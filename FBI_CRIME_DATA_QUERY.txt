/*DATA FROM https://ucr.fbi.gov/crime-in-the-u.s/2016/crime-in-the-u.s.-2016/topic-pages/tables/table-1
  VIOLENT CRIME IS PER 100K
  CREATED IN SQL SERVER
*/
SELECT 
  YEAR
, PREV_VIOLENT_CRIME
, CURR_VIOLENT_CRIME
, CAST(ROUND((CURR_VIOLENT_CRIME - PREV_VIOLENT_CRIME)/ PREV_VIOLENT_CRIME * 100,2) AS decimal(10,2)) AS PCT_CHNG_PREV
FROM
(SELECT ROW_NUMBER() OVER (ORDER BY A.YEAR ASC) AS RN 
,A.YEAR
,LAG(A.VIOLENT_CR_PER_100K) OVER (ORDER BY A.YEAR ASC) AS PREV_VIOLENT_CRIME
,A.VIOLENT_CR_PER_100K AS CURR_VIOLENT_CRIME
,LEAD(A.VIOLENT_CR_PER_100K) OVER (ORDER BY A.YEAR ASC) AS NEXT_VIOLENT_CRIME
FROM
(SELECT YEAR
,CAST(REPLACE(POPULATION1,',','') AS DECIMAL(15,2)) AS US_POPULATION
,CAST(REPLACE(VIOLENT_CRIME2,',','') AS DECIMAL(15,2)) AS VIOLENT_CRIME
,CAST(VIOLENT_CRIME_RATE AS DECIMAL(15,2)) AS VIOLENT_CR_PER_100K
,CAST(VIOLENT_CRIME_RATE AS DECIMAL(15,2))/100000*100 AS VIOLENT_CR_PER_100K_PCT
FROM FBI_CrimeData)A)B
--IGNORE FIRST YEAR ROW SINCE THERE IS NO PREVIOUS NUMBER FOR COMPARISON
WHERE RN > 1
;